<style>
    .grid-info {
        margin-bottom: 20px;
        overflow: auto;
        min-height: 250px;
    }
    .zoomWindow {
        border: 0 !important;
    }

</style>

<!--MODALS-->
<div class="row">
    <div class="span12">

        <!-- Summary Modal -->
        <div id="summaryModal" class="modal hide fade">
            <div class="modal-body">
                <div class="modal-image">
                    <img src="//citscitools.cancerresearchuk.org/static/img/mvp-02/tutorial-images/38.png" alt=""/>
                </div>
                <div class="modal-info">
                    <h1>
                        You can now get started analysing cancer images
                    </h1>
                    <ul>
                        <li>
                            To identify <b>cancer cells</b>, look for <b>blotchy cells</b> grouped together in
                            <b>uneven clumps, loose rings</b> or <b>broken chains.</b>
                        </li>
                        <li>
                            <b>Click once</b> to turn sections <b>containing cancer cells
                            <strong class="text-error">red</strong></b>
                        </li>
                        <li>
                            Healthy cells include the dark blue or dark brown, small and round blood cells
                        </li>
                        <li>
                            Other healthy cells includes the light blue stretched and wispy looking stromal cells
                        </li>
                        <li>
                            <b>Double click</b> to turn sections that only <b>contain healthy cells
                            <strong class="text-success">green</strong></b>
                        </li>
                        <li>
                            <b>Leave blank</b> sections that <b>do not contain any cells</b>
                        </li>
                        <li>
                            Images can contain no cancer, a few cancer cells, lots of cancer cells or all cancer cells
                        </li>
                        Press Start to begin analysing!
                    </ul>
                </div>
            </div>
            <div class="modal-footer">
                    <button class="btn btn-primary" id="startMechanicBtn" data-dismiss="modal" aria-hidden="true"><i class="icon-thumbs-up"></i> Start</button>
                </div>
        </div>




        <!-- Tutoiral Modal -->
        <div id="tutorialModal" class="modal hide fade">

            <div id="0" class="modal-body" style="display:none">

                <div class="modal-image">
                    <img src="//citscitools.cancerresearchuk.org/static/img/mvp-02/tutorial-images/38.png" alt=""/>
                </div>
                <div class="modal-info">
                    <h1>Welcome to Trailblazer!</h1>

                    <p>
                        We need your help identifying cancer cells, from healthy cells in images like the one to the left.
                    </p>
                </div>

            </div>

            <div id="1" class="modal-body" style="display:none">

                <div class="modal-image">
                    <img src="//citscitools.cancerresearchuk.org/static/img/mvp-02/tutorial-images/village.png" alt=""/>
                </div>
                <div class="modal-info">
                    <h1>
                        Healthy cells are very strictly organised and controlled.
                    </h1>

                    <p>
                        This is similar to the houses in this town. They’ve been carefully planned and built to strict guidelines,

                        taking other houses in the area into consideration. Permission is needed to make any changes to this

                        highly regulated town.
                    </p>
                </div>
            </div>

            <div id="2" class="modal-body" style="display:none">

                <div class="modal-image">
                    <img src="//citscitools.cancerresearchuk.org/static/img/mvp-02/tutorial-images/towns.png" alt=""/>
                </div>
                <div class="modal-info">
                    <h1>
                        But, in cancer, cells become less tightly controlled.
                    </h1>

                    <p>
                        When cells become cancerous, they become less tightly controlled. They replicate to make more cells

                        whenever and however they can with little consideration to rules and regulations.
                    </p>

                    <p>

                        Our town is rapidly expanding, with buildings of all shapes and sizes sprouting up wherever they find

                        space.
                    </p>
                </div>
            </div>

            <div id="3" class="modal-body" style="display:none">

                <div class="modal-image">
                    <img src="//citscitools.cancerresearchuk.org/static/img/mvp-02/tutorial-images/city.png" alt=""/>
                </div>
                <div class="modal-info">
                    <h1>
                        In serious cases, cancer becomes a sprawling mass of disorganised cells, which take on all kinds of

                        shapes and sizes.
                    </h1>

                    <p>
                        Our town has grown into a crowded and varied city. With continued growth and lack of control, it starts

                        to spread and take over neighbouring areas.
                    </p>
                </div>
            </div>

            <!--WITH CAROUSEL-->
            <div id="4" class="modal-body" style="display:none">
                <div class="modal-image">
                    <div class="carousel slide" id="myCarousel4">
                        <!-- Carousel items -->
                        <div class="carousel-inner">
                            <div class="active item">
                                <img class="tutorialZoom4" src="//citscitools.cancerresearchuk.org/static/img/mvp-02/tutorial-images/38.png"
                                    data-zoom-image="//citscitools.cancerresearchuk.org/static/img/mvp-02/tutorial-images/@2x-min/38@2x-min.png" alt=""/>

                                <div class="item-inner">
                                    <h1>
                                        Sample image 1
                                    </h1>

                                    <h2>
                                        Move your mouse over the image on the left to zoom in and see more detail.
                                    </h2>

                                    <p>
                                        To identify <b>cancer cells</b>, look for
                                        <b>blotchy cells</b> grouped together in <b>uneven clumps</b>,
                                        <b>loose rings</b> or
                                        <b>broken chains</b>.
                                    </p>


                                </div>
                            </div>
                            <div class="item">
                                <img class="tutorialZoom4" src="//citscitools.cancerresearchuk.org/static/img/mvp-02/tutorial-images/38-cancer.png"
                                    data-zoom-image="//citscitools.cancerresearchuk.org/static/img/mvp-02/tutorial-images/@2x-min/38-cancer-outline@2x-min.png" alt=""/>

                                <div class="item-inner">
                                    <h1>
                                        Sample image 1
                                    </h1>

                                    <h2>
                                        We’ve highlighted the <b>cancer cells</b> in
                                        <b class="text-error">red</b> in this image.
                                    </h2>
                                </div>
                            </div>
                            <div class="item">
                                <img class="tutorialZoom4" src="//citscitools.cancerresearchuk.org/static/img/mvp-02/tutorial-images/38-non-cancer.png"
                                    data-zoom-image="//citscitools.cancerresearchuk.org/static/img/mvp-02/tutorial-images/@2x-min/38-non-cancer-outline@2x-min.png" alt=""/>

                                <div class="item-inner">
                                    <h1>
                                        Sample image 1
                                    </h1>

                                    <h2>
                                        The remaining cells are <b>healthy</b> and have been highlighted in
                                        <b class="text-success">green</b>. They include:
                                    </h2>
                                    <ol>
                                        <li>Blood cells.
                                            <ul>
                                                <li>These are <b>small, dark blue and round</b>.</li>
                                                <li>Sometimes they appear as <b>dark brown spots</b></li>
                                                <li>They can appear loosely spread out or in very dense clusters.</li>
                                            </ul>
                                        </li>
                                        <li>Stromal cells.
                                            <ul>
                                                <li>These are often <b>light blue, wispy or stretched looking</b></li>
                                                <li>They often look like they are flowing or being stretched in a particular direction</li>
                                            </ul>
                                        </li>
                                    </ol>
                                </div>
                            </div>

                        </div>
                        <div class="carousel-indicators-custom" id="carouselIndicatorsList4"></div>
                        <!-- Carousel nav -->
                        <!--<a class="carousel-control left">&lsaquo;</a>-->
                        <!--<a class="carousel-control right">&rsaquo;</a>-->
                    </div>
                </div>
                <div class="modal-info"></div>

            </div>

            <!--WITH CAROUSEL-->
            <div id="5" class="modal-body" style="display:none">
                <div class="modal-image">
                    <div class="carousel slide" id="myCarousel5">
                        <!-- Carousel items -->
                        <div class="carousel-inner">
                            <div class="active item">
                                <img class="tutorialZoom5" src="//citscitools.cancerresearchuk.org/static/img/mvp-02/tutorial-images/13.png"
                                    data-zoom-image="//citscitools.cancerresearchuk.org/static/img/mvp-02/tutorial-images/@2x-min/13@2x-min.png" alt=""/>

                                <div class="item-inner">
                                    <h1>
                                        Sample image 2
                                    </h1>

                                    <h2>
                                        Cancer cells can look very different from image to image.
                                    </h2>

                                    <h2>
                                        This time they have irregular rings and chains with a few uneven clumps of cells
                                    </h2>

                                    <p>
                                        Have a look at the image on the left and try to identify the areas of cancer cells. Then click on 2 to see the answer.
                                    </p>

                                    <p>
                                        Move your mouse over the image on the left to zoom in and see more detail.
                                    </p>

                                </div>
                            </div>
                            <div class="item">
                                <img class="tutorialZoom5" src="//citscitools.cancerresearchuk.org/static/img/mvp-02/tutorial-images/13-cancer.png"
                                    data-zoom-image="//citscitools.cancerresearchuk.org/static/img/mvp-02/tutorial-images/@2x-min/13-cancer-outline@2x-min.png" alt=""/>

                                <div class="item-inner">
                                    <h1>
                                        Sample image 2
                                    </h1>

                                    <h2>
                                        We’ve highlighted the cancer cells in
                                        <b class="text-error">red</b> for this image.
                                    </h2>
                                </div>
                            </div>
                            <div class="item">
                                <img class="tutorialZoom5" src="//citscitools.cancerresearchuk.org/static/img/mvp-02/tutorial-images/13-non-cancer.png"
                                    data-zoom-image="//citscitools.cancerresearchuk.org/static/img/mvp-02/tutorial-images/@2x-min/13-non-cancer-outline@2x-min.png" alt=""/>

                                <div class="item-inner">
                                    <h1>
                                        Sample image 2
                                    </h1>

                                    <h2>
                                        There will be different types of
                                        <b>healthy cells</b> in the images. The two most common types will be:
                                    </h2>
                                    <ol>
                                        <li>Blood cells.
                                            <ul>
                                                <li>These are <b>small, dark blue and round</b>.</li>
                                                <li>Sometimes they appear as <b>dark brown spots</b></li>
                                                <li>They can appear loosely spread out or in very dense clusters.</li>
                                            </ul>
                                        </li>
                                        <li>Stromal cells.
                                            <ul>
                                                <li>These are often <b>light blue, wispy or stretched looking</b></li>
                                                <li>They often look like they are flowing or being stretched in a particular direction</li>
                                            </ul>
                                        </li>
                                    </ol>
                                </div>
                            </div>

                            <div class="item">
                                <img class="tutorialZoom5" src="//citscitools.cancerresearchuk.org/static/img/mvp-02/tutorial-images/13-white-blood-cells.png"
                                    data-zoom-image="//citscitools.cancerresearchuk.org/static/img/mvp-02/tutorial-images/@2x-min/13-white-blood-cells-outline@2x-min.png" alt=""/>

                                <div class="item-inner">
                                    <h1>
                                        Sample image 2
                                    </h1>

                                    <h2>
                                        We've highlighted clusters of blood cells in <b class="text-success">green</b>
                                    </h2>
                                    <li>Blood cells.

                                    <li>These are small, dark blue and round.</li>
                                    <li>Sometimes appear as dark brown spots</li>
                                    <li>They can appear loosely spread out or in very dense clusters.</li>

                                    </li>
                                </div>
                            </div>

                        </div>
                        <div class="carousel-indicators-custom" id="carouselIndicatorsList5"></div>
                        <!-- Carousel nav -->
                        <!--<a class="carousel-control left">&lsaquo;</a>-->
                        <!--<a class="carousel-control right">&rsaquo;</a>-->
                    </div>
                </div>
                <div class="modal-info"></div>

            </div>

            <div id="6" class="modal-body" style="display:none">

                <div class="modal-image">
                    <img src="//citscitools.cancerresearchuk.org/static/img/mvp-01/tutorial/grid.jpg" alt=""/>
                </div>
                <div class="modal-info">
                    <h1>
                        Let’s run through an example
                    </h1>

                    <p>
                        We have split the images up into a 6x6 grid. Some of the grid sections contain cancer cells and some of them do not.
                        We’re going to show you what to do.
                    </p>
                </div>

            </div>

            <div id="7" class="modal-body" style="display:none">

                <div class="modal-image">
                    <img src="//citscitools.cancerresearchuk.org/static/img/mvp-02/tutorial-images/hover-over.png   " alt=""/>
                </div>
                <div class="modal-info">
                    <h1>Look closely at the cells in each section</h1>

                    <p>
                        Like we have done here, you can zoom by hovering over the cells in each section to get a closer look.
                    </p>
                </div>
            </div>

            <div id="8" class="modal-body" style="display:none">

                <div class="modal-image">
                    <img src="//citscitools.cancerresearchuk.org/static/img/mvp-01/tutorial/grid-red.jpg" alt=""/>
                </div>
                <div class="modal-info">
                    <h1>
                        For any section <b>containing a cancer cell</b>, we’ve <b>clicked once</b> to turn it
                        <b class="text-error">red</b>
                    </h1>

                    <p>
                        Examine each section and if you think it contains cancer cells (even if you only see one or two cells)

                        <b>click once to turn that section <strong class="text-error">red.</strong></b>
                    </p>
                </div>

            </div>

            <div id="9" class="modal-body" style="display:none">

                <div class="modal-image">
                    <img src="//citscitools.cancerresearchuk.org/static/img/mvp-01/tutorial/grid-red-green.jpg" alt=""/>
                </div>
                <div class="modal-info">
                    <h1>
                        For any section that <b>only contains healthy cells</b>, we’ve <b>double clicked</b> to turn it
                        <b class="text-success">green</b>
                    </h1>

                    <p>
                        Examine each section and if you think it <b>only contains healthy cells</b>, you can
                        <b>double click</b> to turn that section <strong class="text-success">green</strong>.
                    </p>
                </div>

            </div>

            <div id="10" class="modal-body" style="display:none">

                <div class="modal-image">
                    <img src="//citscitools.cancerresearchuk.org/static/img/mvp-01/tutorial/grid-red-green.jpg" alt=""/>
                </div>
                <div class="modal-info">
                    <h1>
                        Empty sections can be left blank
                    </h1>

                    <p>
                        You can ignore any sections that are empty, normally corner and edge sections (but not always).

                        You can then click on the green “Next slide” to move onto the next sample.
                    </p>
                </div>

            </div>


            <!--&lt;!&ndash;THIS IS mvp-03&ndash;&gt;-->

            <!--&lt;!&ndash;WITH CAROUSEL&ndash;&gt;-->
            <!--<div id="11" class="modal-body" style="display:none">-->
                <!--<div class="modal-image">-->
                    <!--<div class="carousel slide" id="myCarousel11">-->
                        <!--&lt;!&ndash; Carousel items &ndash;&gt;-->
                        <!--<div class="carousel-inner">-->
                            <!--<div class="active item">-->
                                <!--<img class="tutorialZoom11" src="//citscitools.cancerresearchuk.org/static/img/mvp-02/tutorial-images/1.png"-->
                                    <!--data-zoom-image="//citscitools.cancerresearchuk.org/static/img/mvp-02/tutorial-images/@2x-min/1@2x-min.png" alt=""/>-->

                                <!--<div class="item-inner">-->
                                    <!--<h1>-->
                                        <!--Sample image 3-->
                                    <!--</h1>-->

                                    <!--<h2>-->
                                        <!--Have a look at the image on the left and try to identify the areas of cancer cells. Then click on 2 to see the answer.-->
                                    <!--</h2>-->

                                    <!--<p>-->
                                        <!--Move your mouse over the image on the left to zoom in and see more detail.-->
                                    <!--</p>-->
                                <!--</div>-->
                            <!--</div>-->
                            <!--<div class="item">-->
                                <!--<img class="tutorialZoom11" src="//citscitools.cancerresearchuk.org/static/img/mvp-02/tutorial-images/1-cancer.png"-->
                                    <!--data-zoom-image="//citscitools.cancerresearchuk.org/static/img/mvp-02/tutorial-images/@2x-min/1-cancer-outline@2x-min.png" alt=""/>-->

                                <!--<div class="item-inner">-->
                                    <!--<h1>-->
                                        <!--Sample image 3-->
                                    <!--</h1>-->

                                    <!--<h2>-->
                                        <!--The cancer cells have been outlined in <b class="text-error">red</b>.-->
                                    <!--</h2>-->

                                    <!--<p>-->
                                        <!--Most are quite large but their shapes and sizes are quite different.-->
                                    <!--</p>-->

                                    <!--<p>-->

                                        <!--They have formed uneven, lumpy rings and chains.-->
                                    <!--</p>-->
                                <!--</div>-->
                            <!--</div>-->
                            <!--<div class="item">-->
                                <!--<img class="tutorialZoom11" src="//citscitools.cancerresearchuk.org/static/img/mvp-02/tutorial-images/1-non-cancer.png"-->
                                    <!--data-zoom-image="//citscitools.cancerresearchuk.org/static/img/mvp-02/tutorial-images/@2x-min/1-non-cancer-outline@2x-min.png" alt=""/>-->

                                <!--<div class="item-inner">-->
                                    <!--<h1>-->
                                        <!--Sample image 3-->
                                    <!--</h1>-->

                                    <!--<h2>-->
                                        <!--Healthy cells have been outlined in <b class="text-success">green</b>.-->
                                    <!--</h2>-->

                                    <!--<p>-->
                                        <!--The longer and thinner blue cells are stromal cells.-->

                                    <!--</p>-->

                                    <!--<p>-->
                                        <!--The small blue round cells and the dark brown spots are blood cells.-->
                                    <!--</p>-->
                                <!--</div>-->
                            <!--</div>-->
                        <!--</div>-->
                        <!--<div class="carousel-indicators-custom" id="carouselIndicatorsList11"></div>-->
                    <!--</div>-->
                <!--</div>-->
                <!--<div class="modal-info"></div>-->

            <!--</div>-->

            <!--&lt;!&ndash;WITH CAROUSEL&ndash;&gt;-->
            <!--<div id="12" class="modal-body" style="display:none">-->
                <!--<div class="modal-image">-->
                    <!--<div class="carousel slide" id="myCarousel12">-->
                        <!--&lt;!&ndash; Carousel items &ndash;&gt;-->
                        <!--<div class="carousel-inner">-->
                            <!--<div class="active item">-->
                                <!--<img class="tutorialZoom12" src="//citscitools.cancerresearchuk.org/static/img/mvp-02/tutorial-images/26.png"-->
                                    <!--data-zoom-image="//citscitools.cancerresearchuk.org/static/img/mvp-02/tutorial-images/@2x-min/26@2x-min.png" alt=""/>-->

                                <!--<div class="item-inner">-->
                                    <!--<h1>-->
                                        <!--Sample image 4-->
                                    <!--</h1>-->

                                    <!--<h2>-->
                                        <!--Have a look at the image on the left and try to identify the areas of cancer cells. Then click on 2 to see the answer.-->
                                    <!--</h2>-->

                                    <!--<p>-->
                                        <!--Move your mouse over the image on the left to zoom in and see more detail.-->
                                    <!--</p>-->

                                <!--</div>-->
                            <!--</div>-->
                            <!--<div class="item">-->
                                <!--<img class="tutorialZoom12" src="//citscitools.cancerresearchuk.org/static/img/mvp-02/tutorial-images/26-cancer.png"-->
                                    <!--data-zoom-image="//citscitools.cancerresearchuk.org/static/img/mvp-02/tutorial-images/@2x-min/26-cancer-outline@2x-min.png" alt=""/>-->

                                <!--<div class="item-inner">-->
                                    <!--<h1>-->
                                        <!--Sample image 4-->
                                    <!--</h1>-->

                                    <!--<h2>-->
                                        <!--The cancer cells have been outlined in red.-->
                                    <!--</h2>-->

                                    <!--<p>-->
                                        <!--They are large with strange, blotchy patterns. No two-->

                                        <!--cancer cells look the same.-->
                                    <!--</p>-->
                                <!--</div>-->
                            <!--</div>-->
                            <!--<div class="item">-->
                                <!--<img class="tutorialZoom12" src="//citscitools.cancerresearchuk.org/static/img/mvp-02/tutorial-images/26-non-cancer.png"-->
                                    <!--data-zoom-image="//citscitools.cancerresearchuk.org/static/img/mvp-02/tutorial-images/@2x-min/26-non-cancer-outline@2x-min.png" alt=""/>-->

                                <!--<div class="item-inner">-->
                                    <!--<h1>-->
                                        <!--Sample image 4-->
                                    <!--</h1>-->

                                    <!--<h2>-->
                                        <!--Healthy cells have been outlined in <b class="text-success">green</b>.-->
                                    <!--</h2>-->

                                    <!--<p>-->
                                        <!--The surrounding cells are a flood of small, dark and round blood cells mixed with light blue and wispy-->

                                        <!--stromal cells.-->
                                    <!--</p>-->
                                <!--</div>-->
                            <!--</div>-->

                        <!--</div>-->
                        <!--<div class="carousel-indicators-custom" id="carouselIndicatorsList12"></div>-->
                    <!--</div>-->
                <!--</div>-->
                <!--<div class="modal-info"></div>-->
            <!--</div>-->

            <!--&lt;!&ndash;WITH CAROUSEL&ndash;&gt;-->
            <!--<div id="13" class="modal-body" style="display:none">-->
                <!--<div class="modal-image">-->
                    <!--<div class="carousel slide" id="myCarousel13">-->
                        <!--&lt;!&ndash; Carousel items &ndash;&gt;-->
                        <!--<div class="carousel-inner">-->
                            <!--<div class="active item">-->
                                <!--<img class="tutorialZoom13" src="//citscitools.cancerresearchuk.org/static/img/mvp-02/tutorial-images/42.png"-->
                                    <!--data-zoom-image="//citscitools.cancerresearchuk.org/static/img/mvp-02/tutorial-images/@2x-min/42@2x-min.png" alt=""/>-->

                                <!--<div class="item-inner">-->
                                    <!--<h1>-->
                                        <!--Sample image 5-->
                                    <!--</h1>-->

                                    <!--<h2>-->
                                        <!--Have a look at the image on the left and try to identify the areas of cancer cells. Then click on 2 to see the answer.-->
                                    <!--</h2>-->

                                    <!--<p>-->
                                        <!--Move your mouse over the image on the left to zoom in and see more detail.-->
                                    <!--</p>-->
                                <!--</div>-->
                            <!--</div>-->
                            <!--<div class="item">-->
                                <!--<img class="tutorialZoom13" src="//citscitools.cancerresearchuk.org/static/img/mvp-02/tutorial-images/42-cancer.png"-->
                                    <!--data-zoom-image="//citscitools.cancerresearchuk.org/static/img/mvp-02/tutorial-images/@2x-min/42-cancer-outline@2x-min.png" alt=""/>-->

                                <!--<div class="item-inner">-->
                                    <!--<h1>-->
                                        <!--Sample image 5-->
                                    <!--</h1>-->

                                    <!--<h2>-->
                                        <!--The cancer cells have been outlined in-->
                                        <!--<b class="text-error">red</b>. They have formed rounded clumps.-->
                                    <!--</h2>-->

                                    <!--<p>-->
                                        <!--You can clearly see the outlines of these clumps of cancer cells.-->
                                    <!--</p>-->
                                <!--</div>-->
                            <!--</div>-->
                            <!--<div class="item">-->
                                <!--<img class="tutorialZoom13" src="//citscitools.cancerresearchuk.org/static/img/mvp-02/tutorial-images/42-non-cancer.png"-->
                                    <!--data-zoom-image="//citscitools.cancerresearchuk.org/static/img/mvp-02/tutorial-images/@2x-min/42-non-cancer-outline@2x-min.png" alt=""/>-->

                                <!--<div class="item-inner">-->
                                    <!--<h1>-->
                                        <!--Sample image 5-->
                                    <!--</h1>-->

                                    <!--<h2>-->
                                        <!--Healthy cells have been outlined in <b class="text-success">green</b>.-->
                                    <!--</h2>-->

                                    <!--<p>-->
                                        <!--The healthy cells surrounding the cancer clumps include the small round dark blue or dark brown spots of the blood cells.-->
                                    <!--</p>-->

                                    <!--<p>-->
                                        <!--There are also plenty of stretched looking wispy stromal cells.-->
                                    <!--</p>-->
                                <!--</div>-->
                            <!--</div>-->

                        <!--</div>-->
                        <!--<div class="carousel-indicators-custom" id="carouselIndicatorsList13"></div>-->
                    <!--</div>-->
                <!--</div>-->
                <!--<div class="modal-info"></div>-->
            <!--</div>-->

            <!--<div id="14" class="modal-body" style="display:none">-->

                <!--<div class="modal-image">-->
                    <!--<img class="tutorialZoom14" src="//citscitools.cancerresearchuk.org/static/img/mvp-02/tutorial-images/41.png"-->
                        <!--data-zoom-image="//citscitools.cancerresearchuk.org/static/img/mvp-02/tutorial-images/@2x-min/41@2x-min.png" alt=""/>-->
                <!--</div>-->
                <!--<div class="modal-info">-->
                    <!--<h1>-->
                        <!--Sample image 6-->
                    <!--</h1>-->

                    <!--<p>-->
                        <!--Move your mouse over the image on the left to zoom in and see more detail.-->
                    <!--</p>-->

                    <!--<p>-->
                        <!--<b>This image is pretty much all cancer cells!</b>-->
                    <!--</p>-->

                    <!--<p>-->

                        <!--They form strange blotchy patterns with no two cells looking the same. There’s a complete lack of-->

                        <!--organisation or uniformity.-->
                    <!--</p>-->
                <!--</div>-->

            <!--</div>-->

            <!--&lt;!&ndash;WITH CAROUSEL&ndash;&gt;-->
            <!--<div id="15" class="modal-body" style="display:none">-->
                <!--<div class="modal-image">-->
                    <!--<div class="carousel slide" id="myCarousel15">-->
                        <!--&lt;!&ndash; Carousel items &ndash;&gt;-->
                        <!--<div class="carousel-inner">-->
                            <!--<div class="active item">-->
                                <!--<img class="tutorialZoom15" src="//citscitools.cancerresearchuk.org/static/img/mvp-02/tutorial-images/11.png"-->
                                    <!--data-zoom-image="//citscitools.cancerresearchuk.org/static/img/mvp-02/tutorial-images/@2x-min/11@2x-min.png" alt=""/>-->

                                <!--<div class="item-inner">-->
                                    <!--<h1>-->
                                        <!--Sample image 7-->
                                    <!--</h1>-->

                                    <!--<h2>-->
                                        <!--There are lots of different cell types in this image.-->
                                    <!--</h2>-->

                                    <!--<p>-->
                                        <!--Have a look at the image on the left and try to identify the areas of cancer cells. Then click on 2 to see the answer.-->
                                    <!--</p>-->

                                    <!--<p>-->
                                        <!--Move your mouse over the image on the left to zoom in and see more detail.-->
                                    <!--</p>-->
                                <!--</div>-->
                            <!--</div>-->
                            <!--<div class="item">-->
                                <!--<img class="tutorialZoom15" src="//citscitools.cancerresearchuk.org/static/img/mvp-02/tutorial-images/11-healthy.png"-->
                                    <!--data-zoom-image="//citscitools.cancerresearchuk.org/static/img/mvp-02/tutorial-images/@2x-min/11-healthy-outline@2x-min.png" alt=""/>-->

                                <!--<div class="item-inner">-->
                                    <!--<h1>-->
                                        <!--Sample image 7-->
                                    <!--</h1>-->

                                    <!--<p>-->
                                        <!--The cancer cells are outlined in-->
                                        <!--<b class="text-error">red</b>. Some of these cells have taken on very weird shapes and grown exceptionally large.-->
                                    <!--</p>-->

                                    <!--<p>-->
                                        <!--In-->
                                        <!--<b class="text-success">green</b>, we have outlined some healthy lung cells. They are organised and tightly arranged, forming-->

                                        <!--a tight barrier around the airway in the centre of the image.-->
                                    <!--</p>-->
                                <!--</div>-->
                            <!--</div>-->

                            <!--<div class="item">-->
                                <!--<img class="tutorialZoom15" src="//citscitools.cancerresearchuk.org/static/img/mvp-02/tutorial-images/11-white-blood-cells.png"-->
                                    <!--data-zoom-image="//citscitools.cancerresearchuk.org/static/img/mvp-02/tutorial-images/@2x-min/11-white-blood-cells-outline@2x-min.png" alt=""/>-->

                                <!--<div class="item-inner">-->
                                    <!--<h1>-->
                                        <!--Sample image 7-->
                                    <!--</h1>-->

                                    <!--<h2>-->
                                        <!--Now look at the cluster of blood cells outlined in-->
                                        <!--<b class="text-success">green</b>.-->
                                    <!--</h2>-->

                                    <!--<p>-->
                                        <!--They are much smaller and uniform looking than the cancer cells outlined in-->
                                        <!--<b class="text-error">red</b>.-->
                                    <!--</p>-->
                                <!--</div>-->
                            <!--</div>-->

                            <!--<div class="item">-->
                                <!--<img class="tutorialZoom15" src="//citscitools.cancerresearchuk.org/static/img/mvp-02/tutorial-images/11-cartilage.png"-->
                                    <!--data-zoom-image="//citscitools.cancerresearchuk.org/static/img/mvp-02/tutorial-images/@2x-min/11-cartilage-outline@2x-min.png" alt=""/>-->

                                <!--<div class="item-inner">-->
                                    <!--<h1>-->
                                        <!--Sample image 7-->
                                    <!--</h1>-->

                                    <!--<h2>-->
                                        <!--Here, we have outlined the strange structure in the centre of the image in-->
                                        <!--<b class="text-success">green</b>.-->
                                    <!--</h2>-->

                                    <!--<p>-->
                                        <!--This is cartilage. It provides structure and support around the airways of your lungs.-->

                                        <!--If you see this in your images, mark it as healthy cells.-->
                                    <!--</p>-->

                                <!--</div>-->
                            <!--</div>-->

                        <!--</div>-->
                        <!--<div class="carousel-indicators-custom" id="carouselIndicatorsList15"></div>-->
                    <!--</div>-->
                <!--</div>-->
                <!--<div class="modal-info"></div>-->
            <!--</div>-->

            <!--<div id="16" class="modal-body" style="display:none">-->

                <!--<div class="modal-image">-->
                    <!--<img src="//citscitools.cancerresearchuk.org/static/img/mvp-02/tutorial-images/11.png" alt=""/>-->
                <!--</div>-->
                <!--<div class="modal-info">-->
                    <!--<h1>-->
                        <!--You can now get practise analysing cancer images-->
                    <!--</h1>-->
                    <!--<ul>-->
                        <!--<li>-->
                            <!--To identify <b>cancer cells</b>, look for <b>blotchy cells</b> grouped together in-->
                            <!--<b>uneven clumps, loose rings</b> or <b>broken chains.</b>-->
                        <!--</li>-->
                        <!--<li>-->
                            <!--But remember, cancer cells can look very different from image to image-->
                        <!--</li>-->
                        <!--<li>-->
                            <!--<b>Click once</b> to turn sections <b>containing cancer cells-->
                            <!--<strong class="text-error">red</strong></b>-->
                        <!--</li>-->
                        <!--<li>-->
                            <!--Healthy cells include the dark blue or dark brown, small and round blood cells-->
                        <!--</li>-->
                        <!--<li>-->
                            <!--<b>Double click</b> to turn sections that only <b>contain healthy cells-->
                            <!--<strong class="text-success">green</strong></b>-->
                        <!--</li>-->
                        <!--<li>-->
                            <!--<b>Leave blank</b> sections that <b>do not contain any cells</b>-->
                        <!--</li>-->
                        <!--<li>-->
                            <!--Images can contain no cancer, a few cancer cells, lots of cancer cells or all cancer cells-->
                        <!--</li>-->
                    <!--</ul>-->
                <!--</div>-->

            <!--</div>-->

            <div class="modal-footer">
                <button type="button" class="btn closeBtnbtn-default pull-left closeBtn" id="closeBtn" data-dismiss="modal" aria-hidden="true" style="display:none;">Close</button>
                <a id="prevBtn" href="#" class="btn">Previous</a>
                <a id="nextBtn" href="#" class="btn btn-success">Next</a>
                <a class="btn btn-primary closeBtn" id="startFeedbackBtn"    data-dismiss="modal" aria-hidden="true" style="display:none;"><i class="icon-thumbs-up" ></i> Practise</a>
                <button class="btn btn-primary closeBtn pull-right " id="goBackBtn" type="button"  data-dismiss="modal" aria-hidden="true" style="display:none;">Back to task</button>
            </div>
        </div>
    </div>
</div>









<header class="site-header clearfix">
    <div>
        <div id="success" class="alert alert-success" style="display:none">
            <h2><strong>Well done!</strong> Your answer has been saved</h2>
        </div>
        <div id="loading" class="alert alert-info" style="display:none">
            <h2> Loading next task...</h2>
        </div>
        <div id="taskcompleted" class="alert alert-info" style="display:none">
            <h2><strong>The task has been completed!</strong> Thanks a lot!</h2>
        </div>
        <div id="finish" class="alert alert-success" style="display:none">
            <h2><strong>Thank you</strong> for completing the Citizen Science Trailblazer Project!</h2>

            <p>Please let us know your thoughts here.</p>

            <div class="alert-actions">
                <a class="btn small" href="http://citscitools.cancerresearchuk.org/community/mvp-03-feedback/">Give feedback</a>
            </div>
        </div>
        <div id="error" class="alert alert-error" style="display:none">
            <h2><strong>Error!</strong> Something went wrong, please contact the site administrators</h2>
        </div>
    </div>
</header>


<main class="site-content clearfix">


    <div class="mechanic-content" id="mechanic-content" style="display:none;">

        <div class="row clearfix">
            <div class="span12">
                <h1>Mechanic</h1>
            </div>
            <!--Left hand side-->
            <div class="span6">
                <div id="grid-info" class="grid-info">

                    <div class="grid-info-instructions">
                        <h1 id="question">Select which grid sections contain cancer cells</h1>

                        <p>
                            Click once for <strong>cancer</strong> cells in <span class="text-error">red</span>
                            <br/> Double click for <strong>non-cancer</strong> cells in
                            <span class="text-success">green</span>
                            <br/> Leave blank for empty sections.

                        </p>

                        <p class="imgId"></p>
                    </div>

                    <!--<select class="grid-info-difficulty" id="difficulty">-->
                    <!--<option value="0" selected>Please select an image difficulty level:</option>-->
                    <!--<option value="1">1 - Very easy</option>-->
                    <!--<option value="2">2 - Easy</option>-->
                    <!--<option value="3">3 - Average</option>-->
                    <!--<option value="4">4 - Difficult</option>-->
                    <!--<option value="5">5 - Very difficult</option>-->
                    <!--</select>-->

                    <div class="grid-info-buttons">
                        <button class="btn" id="selectAllBtn" value="all">Select All</button>
                        <button class="btn" id="deselectBtn">Deselect All</button>
                        <button class="btn btn-primary" id="showTutorialModalBtn">Tutorial</button>
                        <button class="btn btn-answer btn-success nextSlideBtn" id="nextSlideBtn" value="next">Next slide</button>
                    </div>

                    <div class="progress progress-striped">
                        <div id="progress" rel="tooltip" title="#" class="bar" style="width: 0%;"></div>
                    </div>
                </div>
                <br/>

                <div id="errorClick" class="alert alert-info" style="display:none">
                    <h2>If you are having problems clicking the grid, please refresh the page by clicking
                        <b onclick="location.reload();" style="cursor:pointer;"><u>here</u></b></h2>
                </div>
            </div>

            <!--Right hand side-->
            <div class="span6 wrapper grid-wrapper" id="grid-wrapper">
                <a id="photo-link"></a>

                <div class="canvas" id="mechanicCanvas"></div>
            </div>
        </div>

    </div>


    <div class="feedback-content" id="feedback-content">


        <div class="row clearfix">
            <!--Left hand side-->
            <div class="span12">
                <h1 id="question">Feedback</h1>
            </div>

            <div class="span6">
                <div id="feedback-grid-info" class="grid-info">

                    <div class="grid-info-instructions" id="feedbackStep0">
                        <p>
                            Click once for <strong>cancer</strong> cells in <span class="text-error">red</span>
                            <br/> Double click for <strong>non-cancer</strong> cells in
                            <span class="text-success">green</span>
                            <br/> Leave blank for empty sections.

                        </p>

                        <p>
                            This time we’ll give you immediate feedback on whether our
                            expert pathologists agreed with you.
                        </p>
                        <p>
                            You can change your answer as often as you want.

                            When you’re done click Next Slide
                        </p>

                        <p class="imgId"></p>
                    </div>

                    <div class="grid-info-instructions" id="feedbackStep1" style="display:none;">
                        <p>
                            Click once for <strong>cancer</strong> cells in <span class="text-error">red</span>
                            <br/> Double click for <strong>non-cancer</strong> cells in
                            <span class="text-success">green</span>
                            <br/> Leave blank for empty sections.

                        </p>

                        <p>
                            This time do your best and then click Check my work to see if our expert pathologists agreed with you.
                        </p>

                        <p class="imgId"></p>
                    </div>

                    <div class="grid-info-instructions" id="feedbackStep2" style="display:none;">
                        <p>
                            Click once for <strong>cancer</strong> cells in <span class="text-error">red</span>
                            <br/> Double click for <strong>non-cancer</strong> cells in
                            <span class="text-success">green</span>
                            <br/> Leave blank for empty sections.

                        </p>

                        <p>
                            We’ve compared your analysis with that made by our expert pathologists.

Mouse over the image to explore differences.

To reveal areas of cancer click Show cancer cells.

To hide the shading and ticks/crosses click Hide my analysis

                        </p>

                        <p class="imgId"></p>
                    </div>


                    <div class="grid-info-buttons">
                        <a class="btn btn-success pull-right" id="nextFeedbackStep">
                            Next slide
                        </a>
                        <a class="btn btn-success pull-right" id="finishFeedback" style="display:none;">
                            Start analysis
                        </a>
                        <a class="btn " id="showAnswers" style="display:none;">
                            Show answers
                        </a>
                        <a class="btn " id="hideAnswers" style="display:none;">
                            Hide answers
                        </a>

                         <a class="btn btn-success pull-right disabled" id="checkMyWorkBtn" style="display:none;">
                            Check my work
                        </a>
                        <a class="btn" id="showMyAnalysisBtn" style="display:none;">
                            Show my analysis
                        </a>
                        <a class="btn" id="hideMyAnalysisBtn" style="display:none;">
                            Hide my analysis
                        </a>
                    </div>

                </div>
                <div id="pathologistFeedback" class="alert alert-info">
                    <h2><strong>Our expert pathologists said:</strong></h2>

                    <p></p>
                </div>

            </div>

            <!--Right hand side-->
            <div class="span6 wrapper grid-wrapper" id="grid-wrapper">
                <a id="feedback-photo-link"></a>

                <div class="canvas" id="feedbackCanvas"></div>
            </div>
        </div>

    </div>


</main>


<!--<h2>Cell Examples</h2>-->
<!--<div class="row example-list clearfix">-->

<!--<figure class="example-list-item">-->
<!--<img src="//citscitools.cancerresearchuk.org/static/img/mvp-03/examples/cancer-examples/cancer-cells-example1.jpg" alt=""/>-->
<!--<figcaption class="description cancer">Cancer Cells</figcaption>-->
<!--</figure>-->
<!--<figure class="example-list-item">-->
<!--<img src="//citscitools.cancerresearchuk.org/static/img/mvp-03/examples/cancer-examples/cancer-cells-example2.jpg" alt=""/>-->
<!--<figcaption class="description cancer">Cancer Cells</figcaption>-->
<!--</figure>-->
<!--<figure class="example-list-item">-->
<!--<img src="//citscitools.cancerresearchuk.org/static/img/mvp-03/examples/cancer-examples/cancer-cells-example3.jpg" alt=""/>-->
<!--<figcaption class="description cancer">Cancer Cells</figcaption>-->
<!--</figure>-->
<!--<figure class="example-list-item">-->
<!--<img src="//citscitools.cancerresearchuk.org/static/img/mvp-03/examples/cancer-examples/cancer-cells-example4.jpg" alt=""/>-->
<!--<figcaption class="description cancer">Cancer Cells</figcaption>-->
<!--</figure>-->
<!--<figure class="example-list-item">-->
<!--<img src="//citscitools.cancerresearchuk.org/static/img/mvp-03/examples/cancer-examples/cancer-cells-example5.jpg" alt=""/>-->
<!--<figcaption class="description cancer">Cancer Cells</figcaption>-->
<!--</figure>-->
<!--<figure class="example-list-item">-->
<!--<img src="//citscitools.cancerresearchuk.org/static/img/mvp-03/examples/cancer-examples/cancer-cells-example6.jpg" alt=""/>-->
<!--<figcaption class="description cancer">Cancer Cells</figcaption>-->
<!--</figure>-->
<!--<figure class="example-list-item">-->
<!--<img src="//citscitools.cancerresearchuk.org/static/img/mvp-03/examples/cancer-examples/cancer-cells-example7.jpg" alt=""/>-->
<!--<figcaption class="description cancer">Cancer Cells</figcaption>-->
<!--</figure>-->
<!--<figure class="example-list-item">-->
<!--<img src="//citscitools.cancerresearchuk.org/static/img/mvp-03/examples/cancer-examples/cancer-cells-example8.jpg" alt=""/>-->
<!--<figcaption class="description cancer">Cancer Cells</figcaption>-->
<!--</figure>-->
<!--<figure class="example-list-item">-->
<!--<img src="//citscitools.cancerresearchuk.org/static/img/mvp-03/examples/cancer-examples/cancer-cells-example9.jpg" alt=""/>-->
<!--<figcaption class="description cancer">Cancer Cells</figcaption>-->
<!--</figure>-->
<!--<figure class="example-list-item">-->
<!--<img src="//citscitools.cancerresearchuk.org/static/img/mvp-03/examples/cancer-examples/cancer-cells-example10.jpg" alt=""/>-->
<!--<figcaption class="description cancer">Cancer Cells</figcaption>-->
<!--</figure>-->


<!--<figure class="example-list-item">-->
<!--<img src="//citscitools.cancerresearchuk.org/static/img/mvp-03/examples/cancer-healthy-cells/example-healthy-blood-cells.jpg" alt=""/>-->
<!--<figcaption class="description non-cancer">Healthy cells</figcaption>-->
<!--</figure>-->
<!--<figure class="example-list-item">-->
<!--<img src="//citscitools.cancerresearchuk.org/static/img/mvp-03/examples/cancer-healthy-cells/example-healthy-lung-stromal-cartilage.jpg" alt=""/>-->
<!--<figcaption class="description non-cancer">Healthy cells</figcaption>-->
<!--</figure>-->
<!--<figure class="example-list-item">-->
<!--<img src="//citscitools.cancerresearchuk.org/static/img/mvp-03/examples/cancer-healthy-cells/example-healthy-stromal-and-blood-cells.jpg" alt=""/>-->
<!--<figcaption class="description non-cancer">Healthy cells</figcaption>-->
<!--</figure>-->
<!--<figure class="example-list-item">-->
<!--<img src="//citscitools.cancerresearchuk.org/static/img/mvp-03/examples/cancer-healthy-cells/example-healthy-stromal-and-blood-cells2.jpg" alt=""/>-->
<!--<figcaption class="description non-cancer">Healthy cells</figcaption>-->
<!--</figure>-->
<!--<figure class="example-list-item last">-->
<!--<img src="//citscitools.cancerresearchuk.org/static/img/mvp-03/examples/cancer-healthy-cells/example-healthy-stromal-cells.jpg" alt=""/>-->
<!--<figcaption class="description non-cancer">Healthy cells</figcaption>-->
<!--</figure>-->
<!--</div>-->


<script type="text/javascript" async="async">

    var project_short_name = "{{ project.short_name }}";
    if (project_short_name == "")
        project_short_name = "mvp-03";

    var cookie_feedback_name = project_short_name + 'feedback';
    var cookie_tutorial_name = project_short_name + 'tutorial';


    /*
        This is the pathologist grid square data that we can check the user answers against
    */

    var data = [
        {
            "info": {
                "imgNumber": "//citscitools.cancerresearchuk.org/static/img/mvp-01/2.jpg",
                "timeTaken": "0:0:41.88",
                "openModalCount": 0,
                "device": "Desktop",
                "squares": [
                    {
                        "column": 0,
                        "answer": null,
                        "row": 0,
                        "cellInfo": "This is a blah blah cell"
                    },
                    {
                        "column": 1,
                        "answer": true,
                        "row": 0
                    },
                    {
                        "column": 2,
                        "answer": true,
                        "row": 0
                    },
                    {
                        "column": 3,
                        "answer": true,
                        "row": 0
                    },
                    {
                        "column": 4,
                        "answer": false,
                        "row": 0
                    },
                    {
                        "column": 5,
                        "answer": null,
                        "row": 0
                    },
                    {
                        "column": 0,
                        "answer": true,
                        "row": 1,
                        "cellInfo": "This is a blah blah cell"
                    },
                    {
                        "column": 1,
                        "answer": true,
                        "row": 1,
                        "cellInfo": "This is a blah blah cell"
                    },
                    {
                        "column": 2,
                        "answer": true,
                        "row": 1
                    },
                    {
                        "column": 3,
                        "answer": true,
                        "row": 1
                    },
                    {
                        "column": 4,
                        "answer": false,
                        "row": 1
                    },
                    {
                        "column": 5,
                        "answer": false,
                        "row": 1,
                        "cellInfo": "This is a blah blah cell"
                    },
                    {
                        "column": 0,
                        "answer": true,
                        "row": 2,
                        "cellInfo": "This is a blah blah cell"
                    },
                    {
                        "column": 1,
                        "answer": true,
                        "row": 2
                    },
                    {
                        "column": 2,
                        "answer": false,
                        "row": 2
                    },
                    {
                        "column": 3,
                        "answer": false,
                        "row": 2
                    },
                    {
                        "column": 4,
                        "answer": false,
                        "row": 2
                    },
                    {
                        "column": 5,
                        "answer": false,
                        "row": 2
                    },
                    {
                        "column": 0,
                        "answer": true,
                        "row": 3
                    },
                    {
                        "column": 1,
                        "answer": true,
                        "row": 3
                    },
                    {
                        "column": 2,
                        "answer": true,
                        "row": 3
                    },
                    {
                        "column": 3,
                        "answer": false,
                        "row": 3
                    },
                    {
                        "column": 4,
                        "answer": false,
                        "row": 3
                    },
                    {
                        "column": 5,
                        "answer": false,
                        "row": 3
                    },
                    {
                        "column": 0,
                        "answer": true,
                        "row": 4
                    },
                    {
                        "column": 1,
                        "answer": true,
                        "row": 4
                    },
                    {
                        "column": 2,
                        "answer": true,
                        "row": 4
                    },
                    {
                        "column": 3,
                        "answer": false,
                        "row": 4
                    },
                    {
                        "column": 4,
                        "answer": false,
                        "row": 4
                    },
                    {
                        "column": 5,
                        "answer": false,
                        "row": 4
                    },
                    {
                        "column": 0,
                        "answer": null,
                        "row": 5
                    },
                    {
                        "column": 1,
                        "answer": true,
                        "row": 5
                    },
                    {
                        "column": 2,
                        "answer": true,
                        "row": 5
                    },
                    {
                        "column": 3,
                        "answer": false,
                        "row": 5
                    },
                    {
                        "column": 4,
                        "answer": false,
                        "row": 5
                    },
                    {
                        "column": 5,
                        "answer": null,
                        "row": 5
                    }
                ],
                "browser": "Chrome 43"
            },
            "user_id": 3,
            "task_id": 1971,
            "created": "2015-07-20T11:40:07.640660",
            "finish_time": "2015-07-20T11:40:07.640672",
            "calibration": null,
            "user_ip": null,
            "timeout": null,
            "project_id": 9,
            "id": 1500
        },
        {
            "info": {
                "imgNumber": "//citscitools.cancerresearchuk.org/static/img/mvp-01/4.jpg",
                "timeTaken": "0:0:40.16",
                "openModalCount": 0,
                "device": "Desktop",
                "squares": [
                    {
                        "column": 0,
                        "answer": null,
                        "row": 0
                    },
                    {
                        "column": 1,
                        "answer": null,
                        "row": 0
                    },
                    {
                        "column": 2,
                        "answer": null,
                        "row": 0
                    },
                    {
                        "column": 3,
                        "answer": null,
                        "row": 0
                    },
                    {
                        "column": 4,
                        "answer": null,
                        "row": 0
                    },
                    {
                        "column": 5,
                        "answer": null,
                        "row": 0
                    },
                    {
                        "column": 0,
                        "answer": null,
                        "row": 1
                    },
                    {
                        "column": 1,
                        "answer": false,
                        "row": 1
                    },
                    {
                        "column": 2,
                        "answer": false,
                        "row": 1
                    },
                    {
                        "column": 3,
                        "answer": false,
                        "row": 1
                    },
                    {
                        "column": 4,
                        "answer": false,
                        "row": 1
                    },
                    {
                        "column": 5,
                        "answer": null,
                        "row": 1
                    },
                    {
                        "column": 0,
                        "answer": false,
                        "row": 2
                    },
                    {
                        "column": 1,
                        "answer": false,
                        "row": 2
                    },
                    {
                        "column": 2,
                        "answer": false,
                        "row": 2
                    },
                    {
                        "column": 3,
                        "answer": false,
                        "row": 2
                    },
                    {
                        "column": 4,
                        "answer": true,
                        "row": 2
                    },
                    {
                        "column": 5,
                        "answer": true,
                        "row": 2
                    },
                    {
                        "column": 0,
                        "answer": true,
                        "row": 3
                    },
                    {
                        "column": 1,
                        "answer": true,
                        "row": 3
                    },
                    {
                        "column": 2,
                        "answer": false,
                        "row": 3
                    },
                    {
                        "column": 3,
                        "answer": false,
                        "row": 3
                    },
                    {
                        "column": 4,
                        "answer": true,
                        "row": 3
                    },
                    {
                        "column": 5,
                        "answer": true,
                        "row": 3
                    },
                    {
                        "column": 0,
                        "answer": true,
                        "row": 4
                    },
                    {
                        "column": 1,
                        "answer": true,
                        "row": 4
                    },
                    {
                        "column": 2,
                        "answer": false,
                        "row": 4
                    },
                    {
                        "column": 3,
                        "answer": false,
                        "row": 4
                    },
                    {
                        "column": 4,
                        "answer": false,
                        "row": 4
                    },
                    {
                        "column": 5,
                        "answer": false,
                        "row": 4
                    },
                    {
                        "column": 0,
                        "answer": true,
                        "row": 5
                    },
                    {
                        "column": 1,
                        "answer": false,
                        "row": 5
                    },
                    {
                        "column": 2,
                        "answer": false,
                        "row": 5
                    },
                    {
                        "column": 3,
                        "answer": false,
                        "row": 5
                    },
                    {
                        "column": 4,
                        "answer": false,
                        "row": 5
                    },
                    {
                        "column": 5,
                        "answer": false,
                        "row": 5
                    }
                ],
                "browser": "Chrome 43"
            },
            "user_id": 3,
            "task_id": 1972,
            "created": "2015-07-20T11:40:47.905264",
            "finish_time": "2015-07-20T11:40:47.905277",
            "calibration": null,
            "user_ip": null,
            "timeout": null,
            "project_id": 9,
            "id": 1501
        },
        {
            "info": {
                "imgNumber": "//citscitools.cancerresearchuk.org/static/img/mvp-01/15.jpg",
                "timeTaken": "0:0:32.18",
                "openModalCount": 0,
                "device": "Desktop",
                "squares": [
                    {
                        "column": 0,
                        "answer": null,
                        "row": 0
                    },
                    {
                        "column": 1,
                        "answer": null,
                        "row": 0
                    },
                    {
                        "column": 2,
                        "answer": true,
                        "row": 0
                    },
                    {
                        "column": 3,
                        "answer": true,
                        "row": 0
                    },
                    {
                        "column": 4,
                        "answer": true,
                        "row": 0
                    },
                    {
                        "column": 5,
                        "answer": null,
                        "row": 0
                    },
                    {
                        "column": 0,
                        "answer": null,
                        "row": 1
                    },
                    {
                        "column": 1,
                        "answer": false,
                        "row": 1
                    },
                    {
                        "column": 2,
                        "answer": true,
                        "row": 1
                    },
                    {
                        "column": 3,
                        "answer": true,
                        "row": 1
                    },
                    {
                        "column": 4,
                        "answer": true,
                        "row": 1
                    },
                    {
                        "column": 5,
                        "answer": true,
                        "row": 1
                    },
                    {
                        "column": 0,
                        "answer": false,
                        "row": 2
                    },
                    {
                        "column": 1,
                        "answer": false,
                        "row": 2
                    },
                    {
                        "column": 2,
                        "answer": true,
                        "row": 2
                    },
                    {
                        "column": 3,
                        "answer": true,
                        "row": 2
                    },
                    {
                        "column": 4,
                        "answer": true,
                        "row": 2
                    },
                    {
                        "column": 5,
                        "answer": true,
                        "row": 2
                    },
                    {
                        "column": 0,
                        "answer": false,
                        "row": 3
                    },
                    {
                        "column": 1,
                        "answer": false,
                        "row": 3
                    },
                    {
                        "column": 2,
                        "answer": true,
                        "row": 3
                    },
                    {
                        "column": 3,
                        "answer": true,
                        "row": 3
                    },
                    {
                        "column": 4,
                        "answer": true,
                        "row": 3
                    },
                    {
                        "column": 5,
                        "answer": true,
                        "row": 3
                    },
                    {
                        "column": 0,
                        "answer": true,
                        "row": 4
                    },
                    {
                        "column": 1,
                        "answer": true,
                        "row": 4
                    },
                    {
                        "column": 2,
                        "answer": true,
                        "row": 4
                    },
                    {
                        "column": 3,
                        "answer": true,
                        "row": 4
                    },
                    {
                        "column": 4,
                        "answer": true,
                        "row": 4
                    },
                    {
                        "column": 5,
                        "answer": true,
                        "row": 4
                    },
                    {
                        "column": 0,
                        "answer": null,
                        "row": 5
                    },
                    {
                        "column": 1,
                        "answer": true,
                        "row": 5
                    },
                    {
                        "column": 2,
                        "answer": true,
                        "row": 5
                    },
                    {
                        "column": 3,
                        "answer": true,
                        "row": 5
                    },
                    {
                        "column": 4,
                        "answer": true,
                        "row": 5
                    },
                    {
                        "column": 5,
                        "answer": true,
                        "row": 5
                    }
                ],
                "browser": "Chrome 43"
            },
            "user_id": 3,
            "task_id": 1973,
            "created": "2015-07-20T11:41:20.199301",
            "finish_time": "2015-07-20T11:41:20.199314",
            "calibration": null,
            "user_ip": null,
            "timeout": null,
            "project_id": 9,
            "id": 1502
        }
    ]


    "use strict";


    /**
     * Grid Constructor function
     * =======================
     * Its a bit of a miss match of vanilla JS and jQuery...sorry,
     * wanted to do everything in JS but for speed i did jQuery
     * =======================
     *
     *
     */

    function Grid(task) {

        this.canvas;
        this.feedbackStep = step;
        this.tickCross = [];
        this.task = task;


        /*
            If we are on the main mechanic the pass in the task object from Pybossa.
            Else we are on the feedback section task is returned as undefined
            so we create a temporary object to "store" some data in about the users
            feedback.
        */

        if( typeof this.task !== "undefined" ) {
            this.task = task;
            this.zoomLensClickEvent();
        }

        else {
             this.feedbackObj = {
                tickCross: [],
                feedbackStep: step,
                answer: {
                    squares: []
                }
            };
            this.zoomLensClickEvent();
        }
    }


    /*
        For creating a grid overlayed over the image
    */

    Grid.prototype.createGrid = function (canvasElement) {


        var rows = 6,
            columns = 6,
            gridHeight = 460 / columns,
            gridWidth = 460 / rows;

        this.canvas = Raphael(canvasElement, 460, 460);


        /*
            creates 36 grid squares in raphael
        */

        var x, y, i = -1;
        for (y = 0; y < rows; y += 1) {
            for (x = 0; x < columns; x += 1) {

                i++;

                var offsetH = y,
                    offsetW = x,
                    moveDown = (y + gridHeight - offsetH) * y,
                    moveRight = (x + gridWidth - offsetW) * x,
                    gridSquare = this.canvas.rect(moveRight, moveDown, gridWidth, gridHeight).attr({
                        "stroke": "#fff"
                    });
                gridSquare.node.setAttribute("class", "grid-item");


                /*
                    Make sure grid squares start from id 0
                */

                gridSquare.id = i;

                gridSquare.column = x;
                gridSquare.row = y;
                gridSquare.has_cancer = null;

                /*
                    Save all grid squares in array within main task object
                    We can then grab this when saving the info at the end
                */

                if (typeof this.task != 'undefined') {
                    this.task.answer.squares.push(gridSquare);
                } else {
                    this.feedbackObj.answer.squares.push(gridSquare);
                }

            }
        }

    };


    /*
        Initalise and listen for the click on on the little zoom lens and then
        use Raphaeljs functions to find the closest square.
    */

    Grid.prototype.zoomLensClickEvent = function () {

        var clicks = 0,
            timer = null,
            _this = this;

        $("body").on("click touchstart", ".zoomLens", function (evt) {
            evt.preventDefault();
            clicks++; //count clicks

            if(  step == 1 ) _this.hideMyAnalysis();

            var activeSquare = _this.findClosestSquare();
            var activeSquareNode = activeSquare.node;


            /*
                Not able to use jQuery .click or .dblclick for some reason i can't remember
                If we can then should use jQuery...might be quicker and easier
            */

            // SINGLE CLICK
            if (clicks === 1) {



                //(function (activeSquareNode) {
                    timer = setTimeout(function () {
                        // Adds and removes classes to grid squares making them red or green

                        if (activeSquareNode.className.animVal != "grid-item grid-item-success") {


                            activeSquareNode.setAttribute("class", "grid-item grid-item-success");
                            activeSquare.has_cancer = true;


                            if ($("#feedback-content").is(':visible')) {
                                _this.checkAnswer(true, activeSquare);
                            }


                        } else {

                            activeSquareNode.setAttribute("class", "grid-item");
                            activeSquare.has_cancer = null;

                            if ($("#feedback-content").is(':visible')) {
                                _this.checkAnswer(null, activeSquare);
                            }


                        } //after action performed, reset counter
                        clicks = 0;
                    }, 250);

                //}(activeSquareNode));

            }
            // DOUBLE CLICK
            else {
                clearTimeout(timer); //prevent single-click action

                activeSquareNode.setAttribute("class", "grid-item grid-item-error");
                activeSquare.has_cancer = false;

                if ($("#feedback-content").is(':visible')) {
                    _this.checkAnswer(false, activeSquare);
                }


                clicks = 0;
            }
        });
    };


    /*
        Loop through the grid items and find the closest matching grid that have the clicked coordinates
    */

    Grid.prototype.findClosestSquare = function () {

        var _this = this,
            activeSquare,
            target = $(".zoomLens"),
            target_pos = {
                x: parseInt(target.css("left")),
                y: parseInt(target.css("top"))
            };

        // Center the zoom cursor to middle of square
        target_pos.x = target_pos.x + 34.85;
        target_pos.y = target_pos.y + 34.85;


        // Find the closet grid item

        if (typeof this.task != 'undefined') {
            $.each(_this.task.answer.squares, function (key, value) {
                if (value.isPointInside(target_pos.x, target_pos.y)) {
                    activeSquare = value;
                }
            });
        } else {
            $.each(_this.feedbackObj.answer.squares, function (key, value) {
                if (value.isPointInside(target_pos.x, target_pos.y)) {
                    activeSquare = value;
                }
            });
        }
        return activeSquare;
    };


    /*
        After the grid square has been click we check that answer against what the
        pathologist said about the same square.
    */

    Grid.prototype.checkAnswer = function (action, activeSquare) {

        var state = action,
            pathologistAnswer,
            activeSquare = activeSquare;

        $.each(data[step].info, function (key, value) {
            if (typeof(value[activeSquare.id]) == 'object') {
                // Find the pathologist answer for that square
                pathologistAnswer = value[activeSquare.id];
            }
        });

        var activeSquarePosCX = activeSquare.attr("x") + 30,
            activeSquarePosCY = activeSquare.attr("y") + 30;

        var parentId = activeSquare.id;

        $.each(this.tickCross, function (key, value) {
            if (parentId === value["data-parent_id"]) {
                value.remove();
            }
        });

        var x = Math.floor(activeSquare.attr("x"));
        var y = Math.floor(activeSquare.attr("y"));
        var tick = "M " + (x + 15) + "," + (y + 35) + " L " + (x + 30) + "," + (y + 50) + " L " + (x + 60) + "," + (y + 20);
        var cross = "M " + (x + 20) + "," + (y + 20) + " L " + (x + 55) + "," + (y + 55) + "M " + (x + 20) + "," + (y + 55) + " L " + (x + 55) + "," + (y + 20);


        if (state === pathologistAnswer.answer) {

            $("#pathologistFeedback").removeClass("alert-info").addClass("alert-success");
            $("#pathologistFeedback p").text("Well done! This is what our pathologist said");


            var tick = this.canvas.path(tick).attr("stroke-width", "3px");

            if( step == 1 || step == 2) tick.attr("opacity",0);

            tick["data-parent_id"] = parentId;
            this.tickCross.push(tick);

        } else {
            //console.log("Dont agree");
            if (pathologistAnswer.answer === true) {
                $("#pathologistFeedback").removeClass("alert-success").addClass("alert-info");
                $("#pathologistFeedback p").text("The pathologies said it contained cancer");
                //activeSquare.node.setAttribute("class", "grid-item grid-item-success");
            }
            if (pathologistAnswer.answer === false) {
                $("#pathologistFeedback").removeClass("alert-success").addClass("alert-info");
                $("#pathologistFeedback p").text("The pathologies said it did not contained cancer");
                //activeSquare.node.setAttribute("class", "grid-item grid-item-error");
            }
            if (pathologistAnswer.answer === null) {
                $("#pathologistFeedback").removeClass("alert-success").addClass("alert-info");
                $("#pathologistFeedback p").text("The pathologies said this square was clear");
                //activeSquare.node.setAttribute("class", "grid-item");
            }

            var cross = this.canvas.path(cross).attr("stroke-width", "3px");

            if( step == 1 || step == 2) cross.attr("opacity",0);

            cross["data-parent_id"] = parentId;
            this.tickCross.push(cross);

        }


        if( this.tickCross.length > 0 && step == 1 ) {
            $("#checkMyWorkBtn").removeClass("disabled");
            //$("#showMyAnalysisBtn, #hideMyAnalysisBtn, #nextFeedbackStep").show();
            //$("#checkMyWorkBtn").hide();
        }
    }



    /*
        Displays the pathologist tick's and cross's by changing the opacity of the square
    */

    Grid.prototype.showMyAnalysis = function () {
        $.each(this.tickCross, function (key, value) {
            value.attr("opacity",1);
        });
    };


    /*
        Hide the pathologist tick's and cross's by changing the opacity of the square
    */

    Grid.prototype.hideMyAnalysis = function () {
        $.each(this.tickCross, function (key, value) {
            value.attr("opacity",0);
        });
    };


    /*
        Selects all of the grid squares turning them red and changing the defalut
        square answer to "true" is does have cancer
    */

    Grid.prototype.selectAllSquares = function () {
        for (var i = 0; i < this.task.answer.squares.length; i++) {
            var gridSquare = this.task.answer.squares[i],
                gridSquareNode = this.task.answer.squares[i].node;
            gridSquare.has_cancer = true;
            gridSquareNode.setAttribute("class", "grid-item grid-item-success");
        }
    }


    /*
        Deselects all of the grid squares turning them to have no fill color.
        This also changes the cancer value to "null"
    */

    Grid.prototype.deselectAllSquares = function () {
        for (var i = 0; i < this.task.answer.squares.length; i++) {
            var gridSquare = this.task.answer.squares[i],
                gridSquareNode = this.task.answer.squares[i].node;
            gridSquare.has_cancer = null;
            gridSquareNode.setAttribute("class", "grid-item");
        }
    }


    /*
        A method that transforms of the grid squares and colors them in showing
        the pathologist answers.
    */

    Grid.prototype.showPathologistAnswers = function () {

        for (var i = 0; i < data[step].info.squares.length; i++) {

            var gridSquare = this.feedbackObj.answer.squares[i],
                gridSquareNode = this.feedbackObj.answer.squares[i].node,
                pathologistAnswer = data[step].info.squares[i].answer;


            if (data[step].info.squares[i].answer == true) {
                gridSquareNode.setAttribute("class", "grid-item grid-item-success");
            }
            if (data[step].info.squares[i].answer == false) {
                gridSquareNode.setAttribute("class", "grid-item grid-item-error");
            }
            if (data[step].info.squares[i].answer == null) {
                gridSquareNode.setAttribute("class", "grid-item");
            }
        }
    }





    /*
     *
     * Modal
     * =======================
     *
     *
     *
     */


    function Modal() {
        this.step = -1;
    }


    /*
        Initialises the modal to open. We remove the functionaly to remove modal by clicking
        the backdrop also we stop the slides from automatically sliding to next.
    */

    Modal.prototype.open = function (modal) {
        $(modal).modal({
            backdrop: 'static',
            keyboard: false
        });
        this.showStep(0);
    };


    Modal.prototype.getCurrentStep = function() {
        return $("#" + this.step);
    };


    Modal.prototype.showStep = function (action) {

        var z = new Zoom();

        var $currentStep = this.getCurrentStep();
        if ($currentStep.is(":visible"))
            $currentStep.hide();


        if (typeof action == "number") {
            this.step = action;
        }
        else{

            if (action == 'next') {
                this.step += 1;
            }
            if (action == 'prev') {
                this.step -= 1;
            }
        }

        if (this.step == 14) {
            $('.zoomContainer').remove();
            $('.zoomWindowContainer').remove();
            $(".tutorialZoom14").elevateZoom();
        }

        var $currentStep = this.getCurrentStep(),
            $carousel = $("#" + this.step + " .carousel"),
            $modalInfo = $("#" + this.step + " .modal-info"),
            $items = $("#" + this.step + " .item");

        if ($carousel.length > 0) {
            $('.zoomContainer').remove();
            $('.zoomWindowContainer').remove();
            var tutorial = ".tutorialZoom" + this.step;

            $(tutorial).elevateZoom();

            if (!$carousel.data("carousel")) {

                $carousel.carousel({
                    interval: false
                });
                var $indicatorList = $("#carouselIndicatorsList" + this.step);

                $($items).each(function (idx) {
                    // Adding buttons
                    var idx = idx + 1,
                        $item = $(this),
                        $li = '<div class="carousel-selector-' + idx + '" type="button">' + idx + '</div>';

                    $indicatorList.append($li);

                    //Adding item-info to modal-info
                    $(this).children(".item-inner");
                    $modalInfo.append($item.children(".item-inner"));
                });

                $currentStep.find(".modal-info .item-inner").first().addClass("active");
                $currentStep.find(".carousel-indicators-custom div").first().addClass("active");


                // When you click on each selector
                // Load new content
                $('[class^=carousel-selector-]').on('click', this.nextSlideContent($currentStep));
            }
        }


        if (this.step == 0) {
            $("#prevBtn").hide();
        } else {
            $("#prevBtn").show();
        }

        if ($("#mechanic-content").is(':visible')) $("#closeBtn").show();

        var $lastStep = $('#tutorialModal .modal-body').length - 1;
        if (this.step == $lastStep) {
            $("#nextBtn").hide();

            if ($("#mechanic-content").is(':visible')) {
                $("#startFeedbackBtn").hide();
                $("#goBackBtn").show();
            } else {
                $("#startFeedbackBtn").show();
                $("#goBackBtn").hide();
            }

        } else {
            $("#nextBtn").show();

        }

        $currentStep.show();

    };


    /*
        If a step in the carousel includes a carousel with multiple slides
        find the content that relates to it and show it one by one.
    */

    Modal.prototype.nextSlideContent = function (carousel) {

        return function () {
            // Add and remove active class
            $(this).parent().children().removeClass("active");
            $(this).addClass("active");

            var id_selector = $(this).attr("class");
            var id = id_selector.substr(id_selector.length - 8);
            id = parseInt(id);
            var $itemInners = carousel.find(".modal-info .item-inner");
            $itemInners.removeClass('active');
            $($itemInners[id - 1]).addClass('active')
            var $modalId = $(this).parent().parent().parent().parent().attr("id");
            $('#myCarousel' + $modalId).carousel(id - 1);
        }

    }






    /*
     *
     * Elevate Zoom
     * =======================
     *
     *
     */


    function Zoom() {

    }


    Zoom.prototype.addZoom = function (element) {
//alert("zoom");
        var cookie = $.cookie(cookie_feedback_name),
            zoomWindowPos;

        if( cookie === "true" )
            zoomWindowPos = "feedback-grid-info";
        else
            zoomWindowPos = "grid-info";

        console.log(zoomWindowPos);

        var zoomWindowPosHeight = $("#" + zoomWindowPos).innerHeight(),
            zoomWindowPosWidth  = $("#" + zoomWindowPos).innerWidth();

    //console.log(zoomWindowPosHeight,zoomWindowPosWidth);

        element.elevateZoom({
            zoomWindowPosition: zoomWindowPos,
            lensFadeIn: 500,
            lensFadeOut: 500,
            zoomWindowHeight: 250,
            zoomWindowWidth: 460,
            cursor: "pointer"
        });



    }


    Zoom.prototype.removeZoom = function (element) {
        $.removeData(element, 'elevateZoom');
        $('.zoomContainer').remove();
        $('.zoomWindowContainer').remove();
    }





    /*
     *
     * Helpful functions
     * =======================
     *
     *
     */


     /*
        Loads user progress into Grid info
     */

    function loadUserProgress() {
        pybossa.userProgress('mvp-03').done(function (data) {
            var pct = Math.round((data.done * 100) / data.total);
            $("#progress").css("width", pct.toString() + "%");
            $("#progress").attr("title", pct.toString() + "% completed!");
            $("#progress").tooltip({
                'placement': 'bottom'
            });
            $("#total").text(data.total);
            $("#done").text(data.done);
        });
    }


    /*
        Uses device.js and works out what device we are using
    */

    function whatDevice() {
        var desktop = device.desktop(),
            mobile = device.mobile(),
            tablet = device.tablet(),
            portrait = device.portrait(),
            landscape = device.landscape(),
            iphone = device.iphone(),
            android = device.android(),
            androidTablet = device.androidTablet(),
            blackberryTablet = device.blackberryTablet();


        if (desktop) return "Desktop";
        if (mobile && portrait) return "Mobile portrait";
        if (mobile && portrait) return "Mobile landscape";
        if (tablet && portrait) return "Tablet portrait";
        if (tablet && landscape) return "Tablet landscape";
    }



     /*
        Finds out how long the user has spent on the particular task.
        We then return this value back into the task.answer object which we get back in pybossa
     */

    function secondsToString(seconds) {
        var numhours = Math.floor(((seconds % 31536000) % 86400) / 3600);
        var numminutes = Math.floor((((seconds % 31536000) % 86400) % 3600) / 60);
        var numseconds = (((seconds % 31536000) % 86400) % 3600) % 60;
        return numhours + ":" + numminutes + ":" + numseconds.toFixed(2);
    }


     /*
        We use modenizr to find out with browser we are on and what version.
        Then it returns this value back into the task.answer object which we get back in pybossa
     */

    var BrowserDetect = {
        init: function () {
            this.browser = this.searchString(this.dataBrowser) || "Other";
            this.version = this.searchVersion(navigator.userAgent) || this.searchVersion(navigator.appVersion) || "Unknown";
        },
        searchString: function (data) {
            for (var i = 0; i < data.length; i++) {
                var dataString = data[i].string;
                this.versionSearchString = data[i].subString;

                if (dataString.indexOf(data[i].subString) !== -1) {
                    return data[i].identity;
                }
            }
        },
        searchVersion: function (dataString) {
            var index = dataString.indexOf(this.versionSearchString);
            if (index === -1) {
                return;
            }

            var rv = dataString.indexOf("rv:");
            if (this.versionSearchString === "Trident" && rv !== -1) {
                return parseFloat(dataString.substring(rv + 3));
            } else {
                return parseFloat(dataString.substring(index + this.versionSearchString.length + 1));
            }
        },

        dataBrowser: [{
            string: navigator.userAgent,
            subString: "Chrome",
            identity: "Chrome"
        }, {
            string: navigator.userAgent,
            subString: "MSIE",
            identity: "Explorer"
        }, {
            string: navigator.userAgent,
            subString: "Trident",
            identity: "Explorer"
        }, {
            string: navigator.userAgent,
            subString: "Firefox",
            identity: "Firefox"
        }, {
            string: navigator.userAgent,
            subString: "Safari",
            identity: "Safari"
        }, {
            string: navigator.userAgent,
            subString: "Opera",
            identity: "Opera"
        }]

    };

    BrowserDetect.init();

    /*
        For displaying a message on IE

        if (BrowserDetect.browser == 'Explorer') {
            //$(".wrappy").addClass("active");
        }
    */






    /*
     * PyBossa functions
     * =======================
     * taskLoaded is the first pybossa method that is called
     * =======================
     *
     *
     */


    pybossa.taskLoaded(function (task, deferred) {

         if (!$.isEmptyObject(task)) {

            var img = $('<img />');
                img.attr('src', task.info.url_b).css('height', 460);
                img.attr('data-zoom-image', task.info.url_b);
                img.addClass('img-polaroid');
                task.info.image = img;

            task.answer = {
                squares: [],
                timeTaken: "",
                device: "",
                browser: "",
                img: "",
                openModalCount: 0
            }

            img.load(function () {

                // continue as soon as the image is loaded
                deferred.resolve(task);

            });

        } else {

            deferred.resolve(task);
        }

    });


     /*
        This grabs the task via an API call using pybossa.js. We retreive all of the task infomation
        in an object called task that we pass into the presentTask method. We first check if there is a task
        If there is then we initalize the Grid constructor and other methods.
     */

    pybossa.presentTask(function (task, deferred) {
        if (!$.isEmptyObject(task)) {


            loadUserProgress();

            /* THESE AND ERROR PUMPING OUT WITH THIS !?!

             $('.example-list').slick({
                dots: true,
                infinite: false,
                speed: 300,
                slidesToScroll: 5,
                slidesToShow: 5
             });

             */


            var openModalCount = 0;

            /*
                Take a time stamp of the time the page loads
            */
            var oldTime = new Date();


            /*
                Load the task image into the page
            */
            $('#photo-link').html('').append(task.info.image);
            $("#question").html(task.info.question);
            $('#task-id').html(task.id);
            var imgUrl = task.info.url_b;
            var result = imgUrl.replace("//citscitools.cancerresearchuk.org/static/img/mvp-01/", "");
            $(".imgId").html("Image ID: " + "<strong>" + result + "</strong>");






            /*
                Initalise main mechanic, zoom and modal
            */

            var grid = new Grid(task);
            grid.createGrid("mechanicCanvas");

            var zoom = new Zoom();
            zoom.addZoom($(".img-polaroid"));

            var modal = new Modal();





            /*
                Event Listeners for various buttons
            */

            var selectBtn = document.getElementById("selectAllBtn");
            selectBtn.onclick = function () {
                grid.selectAllSquares();
            }
            var deselectBtn = document.getElementById("deselectBtn");
            deselectBtn.onclick = function () {
                grid.deselectAllSquares();
            }


            var showTutorialModalBtn = document.getElementById("showTutorialModalBtn");
            showTutorialModalBtn.onclick = function () {
                modal.open( "#tutorialModal" );
                zoom.removeZoom($(".tutorialZoom"));
                openModalCount++;
            };


            var closeBtn = document.getElementById("closeBtn");
            closeBtn.onclick = function () {
                zoom.removeZoom($(".tutorialZoom"));
                $("#errorClick").show();
                zoom.addZoom($(".img-polaroid"));
            };


            var goBackBtn = document.getElementById("goBackBtn");
                goBackBtn.onclick = function () {
                zoom.removeZoom($(".tutorialZoom"));
                $("#errorClick").show();
                zoom.addZoom($(".img-polaroid"));
            };


            var nextBtn = document.getElementById("nextBtn");
            nextBtn.onclick = function () {
                modal.showStep('next');
            };


            var prevBtn = document.getElementById("prevBtn");
            prevBtn.onclick = function () {
                modal.showStep('prev');
            };





            /*
                Tooltips - not used yet
            */

            $('.grid-info-instructions').tooltip({
                selector: "a[data-toggle=tooltip]"
            });
            $('.example-list').tooltip({
                selector: "a[data-toggle=tooltip]"
            });





            /*
                "Next Slide" Button
            */

            $('.btn-answer').off('click').on('click', function () {

                // Grab a new timestamp and find out the difference
                // This is how long the user has been on the task for
                // Then pass it into the answer
                var newTime = new Date(),
                    ms = newTime - oldTime,
                    x = ms / 1000,
                    seconds = secondsToString(x)

                // Pass image number into answer
                var imgUrl = task.info.url_b;
                var result = imgUrl.replace("//citscitools.cancerresearchuk.org/static/img/mvp-01/", "");


                // Create the answer object
                var answer = {
                    squares: [],
                    timeTaken: seconds,
                    device: whatDevice(),
                    browser: BrowserDetect.browser + " V." + BrowserDetect.version,
                    imgNumber: result,
                    openModalCount: openModalCount
                };


                // Change the square object to have clearer values
                $.each(grid.task.answer.squares, function (key, value) {
                    var obj = {
                        column: value.column,
                        row: value.row,
                        answer: value.has_cancer
                    };
                    answer.squares.push(obj);
                });

                console.log(answer);

                /*
                 * Save the task information and send to PyBossa
                 */

                pybossa.saveTask(task.id, answer).done(function (data) {
                    $("#success").fadeIn(500).delay(1000).fadeOut();
                    $("svg, .zoomContainer,.zoomWindowContainer").remove();
                    deferred.resolve();
                });

                //$("#loading").fadeIn(500).delay(500).fadeOut();
            });
        } else {

            $("#loading").hide();
            $("#finish").fadeIn(500);
            $(".span6").fadeTo("slow", 0.5);
        }
    });




    /*
     *  Feedback function
     *  =======================
     *  This has multiple steps that include and init a new grid
     *  we use this funciton to keep the progress through the steps
     *
     */

    var step = -1;

    function showFeedbackStep(action) {

        $("#feedbackStep" + step).hide();

        if (action == 'next') {
            step += 1;
        }
        if (step == 1) {
            $("#nextFeedbackStep").hide();
            $("#checkMyWorkBtn").show();
        }
        if (step == 2) {
            $("#nextFeedbackStep").hide();
            $("#finishFeedback").show();
        }

        $("svg, .feedback-img-polaroid, .zoomContainer, .zoomWindowContainer, .feedback-photo-link").remove();
        $.removeData(".feedback-photo-link", 'elevateZoom');

        var data_obj = data[step].info;
        var imgUrl = data[step].info.imgNumber;

        var img = $('<img />');
        img.attr('src', imgUrl);
        img.attr('data-zoom-image', imgUrl);
        img.addClass('feedback-img-polaroid');

        $('#feedback-photo-link').append(img);

        var grid = new Grid();
        grid.createGrid("feedbackCanvas");

        var zoom = new Zoom();
        zoom.addZoom($(".feedback-img-polaroid"));

        var showAnswers = document.getElementById("showAnswers");
        showAnswers.onclick = function () {
            grid.showPathologistAnswers();
        };

        var hideAnswers = document.getElementById("hideAnswers");
        hideAnswers.onclick = function () {
            grid.hidePathologistAnswers();
        };

        var showMyAnalysis = document.getElementById("showMyAnalysisBtn");
        showMyAnalysis.onclick = function () {
            grid.showMyAnalysis();
        };
        var hideMyAnalysis = document.getElementById("hideMyAnalysisBtn");
        hideMyAnalysis.onclick = function () {
            grid.hideMyAnalysis();
        };

        var checkMyWork = document.getElementById("checkMyWorkBtn");
        checkMyWork.onclick = function () {
            if( $(this).hasClass("disabled") ) return
            $("#showMyAnalysisBtn").show();
            $("#hideMyAnalysisBtn").show();
            grid.showMyAnalysis();
            $("#nextFeedbackStep").show();
            $("#checkMyWorkBtn").hide();
        };

        $("#feedbackStep" + step).show();
    }


    var nextFeedbackBtn = document.getElementById("nextFeedbackStep");
    nextFeedbackBtn.onclick = function () {
        showFeedbackStep('next');
    };






    /*
     * UpdatePageState
     * =======================
     * We use this check the state of cookies to show the relevate sections
     * the three sections are "tutorial", "feedback" and "mechanic"
     *
     */

    function UpdatePageState() {

        // State of the page to show to the user
        var page_state = "mechanic";

        // Check if the page should be in show feedback state
        var cookie_feedback = $.cookie(cookie_feedback_name);
        if (cookie_feedback != null )
            page_state = "feedback";

        // Check if the page should be in tutorial state
        var cookie_tutorial = $.cookie(cookie_tutorial_name);
        if (cookie_tutorial == null || cookie_tutorial != "seen")
            page_state = "tutorial";

        // Check if the page should be in show feedback state
        var cookie_feedback = $.cookie(cookie_feedback_name);
        if (cookie_feedback == "false"  )
            page_state = "mechanic";

        if (page_state == "feedback") {
            showFeedbackStep('next');
            $("#feedback-content").show();
        }
        else if (page_state == "tutorial") {

            var m = new Modal;
            m.open( "#tutorialModal" );

            $("#feedback-content").hide();

            var nextBtn = document.getElementById("nextBtn");
            nextBtn.onclick = function () {
                m.showStep('next');
            };

            var prevBtn = document.getElementById("prevBtn");
            prevBtn.onclick = function () {
                m.showStep('prev');
            };

        } else {
            $("#feedback-content").hide();
            $("#mechanic-content").show();
            pybossa.run("mvp-03");
        }

    }

    $(function () {

        UpdatePageState();

        $("#startFeedbackBtn").on("click", function () {
            $.cookie(cookie_tutorial_name, "seen");
            $.cookie(cookie_feedback_name, true);
            UpdatePageState();
        });

        $("#finishFeedback").on("click", function () {
            $("svg, .feedback-img-polaroid, .zoomContainer, .zoomWindowContainer, .feedback-photo-link").remove();
            $.removeData(".feedback-photo-link", 'elevateZoom');
            var m = new Modal;
            m.open( "#summaryModal" );
        });

        $("#startMechanicBtn").on("click", function(){
            $.cookie(cookie_feedback_name, false);
            UpdatePageState();
        });

    });

</script>




